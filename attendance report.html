<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Attendance Reports</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#141a2f;
      --muted:#8b93a7;
      --text:#e7ecf5;
      --accent:#5b8cff;
      --accent-strong:#3b6df5;
      --radius:16px;
    }
    body{
      margin:0;
      font-family:system-ui, sans-serif;
      background:var(--bg);
      color:var(--text);
      padding:20px;
    }
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:20px;
      box-shadow:0 8px 30px rgba(0,0,0,.35);
      max-width:800px;
      margin:auto;
    }
    h1{margin:0 0 12px}
    table{width:100%; border-collapse:collapse; margin-top:14px}
    th,td{padding:10px; text-align:left}
    th{background:rgba(255,255,255,.05)}
    tr:nth-child(even){background:rgba(255,255,255,.03)}
    .btn{
      padding:8px 14px;
      border:0;
      border-radius:10px;
      font-weight:600;
      cursor:pointer;
      background:linear-gradient(180deg,var(--accent),var(--accent-strong));
      color:#fff;
      text-decoration:none;
    }
    .nav{margin-bottom:18px; display:flex; gap:12px}
    footer{margin-top:18px; color:var(--muted); font-size:.85rem; text-align:center}
  </style>
</head>
<body>
  <main class="card">
    <div class="nav">
      <a href="attendance.html" class="btn">âž• Mark Attendance</a>
      <a href="reports.html" class="btn">ðŸ“Š Reports</a>
    </div>
    <h1>Attendance Reports</h1>
    <p>Summary of attendance records stored locally.</p>

    <table>
      <thead>
        <tr>
          <th>Student Name</th>
          <th>Days Present</th>
          <th>Days Absent</th>
          <th>Total Days</th>
          <th>Percentage</th>
        </tr>
      </thead>
      <tbody id="reportTable"></tbody>
    </table>

    <footer>
      Report generated from localStorage. Connect backend for real system.
    </footer>
  </main>

  <script>
    // Same demo students as in attendance.html
    const students = [
      "Alice Johnson",
      "Brian Lee",
      "Catherine Davis",
      "David Kumar",
      "Emma Smith"
    ];

    const reportTable = document.getElementById("reportTable");

    // Collect all saved attendance records (keys starting with "attendance_")
    function collectData(){
      const data = {};
      for(const s of students){
        data[s] = {present:0, absent:0, total:0};
      }
      for(let i=0;i<localStorage.length;i++){
        const key = localStorage.key(i);
        if(key.startsWith("attendance_")){
          const records = JSON.parse(localStorage.getItem(key) || "{}");
          students.forEach(s=>{
            if(records[s]==="Present"){
              data[s].present++;
              data[s].total++;
            } else if(records[s]==="Absent"){
              data[s].absent++;
              data[s].total++;
            }
          });
        }
      }
      return data;
    }

    function render(){
      const data = collectData();
      reportTable.innerHTML="";
      students.forEach(s=>{
        const rec = data[s];
        const pct = rec.total? ((rec.present/rec.total)*100).toFixed(1)+"%":"â€”";
        const tr=document.createElement("tr");
        tr.innerHTML=`
          <td>${s}</td>
          <td>${rec.present}</td>
          <td>${rec.absent}</td>
          <td>${rec.total}</td>
          <td>${pct}</td>
        `;
        reportTable.appendChild(tr);
      });
    }

    render();
  </script>
</body>
</html>